\documentclass[fleqn]{article}

\usepackage[ngerman]{babel}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{stmaryrd}
\usepackage{tikz}

\newcommand*\circled[1]{\tikz[baseline=(char.base)]{
  \node[shape=circle,draw,inner sep=2pt] (char) {#1};}}
\DeclareMathOperator{\tr}{tr}
\DeclareMathOperator{\rank}{rank}
\DeclareMathOperator{\adj}{adj}
\DeclareMathOperator{\svd}{svd}
\DeclareMathOperator{\UD}{UD}
\DeclareMathOperator{\LR}{LR}
\DeclareMathOperator{\ld}{ld}
\DeclareMathOperator{\SNR}{SNR}


\begin{document}

\begin{titlepage}
\title{Tutorial for MIMO Communication Systems}
\end{titlepage}
\maketitle

\section*{Problem 1}
\begin{align*}
	\mathbf{A} = 
	\begin{pmatrix}
	-1 & 1 \\
	1 & -1
	\end{pmatrix}
	,\quad
	\mathbf{B} = \frac{1}{\sqrt{5}}
	\begin{pmatrix}
	-1 & 2 \\
	2 & 1
	\end{pmatrix}
\end{align*}

\subsection*{a) Eigenvalues}
\begin{align*}
	\det\left(\lambda\mathbf{I-A}\right)\overset{!}{=}0
	\quad&\rightarrow
	\begin{vmatrix}
	\lambda+1 & 1 \\
	1 & \lambda +1
	\end{vmatrix}
	\overset{!}{=}0& \\
	&\Rightarrow\lambda_{1}^{A}=-2,\quad\lambda_{2}^{A}=0& \\
	\det\left(\lambda\mathbf{I-B}\right)\overset{!}{=}0
	\quad&\rightarrow
	\begin{vmatrix}
	\lambda+\frac{1}{\sqrt{5}} & -\frac{2}{\sqrt{5}} \\
	-\frac{2}{\sqrt{5}} & \lambda-\frac{1}{\sqrt{5}}
	\end{vmatrix}
	\overset{!}{=}0& \\
	&\Rightarrow\lambda_{1}^{B}=1,\quad\lambda_{2}^{B}=-1&
\end{align*}

\subsection*{b) Determinant \& Trace}
\begin{align*}
	&\left|\mathbf{A}\right| =
	\begin{vmatrix}
	-1 & 1 \\
	1 & -1
	\end{vmatrix} = 1-1 = 0,\quad
	\left|\mathbf{B}\right| = -1& \\
	&\det\left(\mathbf{A}\right)=
	\begin{vmatrix}
	a_{11} & a_{12} & a_{13} \\
	a_{21} & a_{22} & a_{23} \\
	a_{31} & a_{32} & a_{33}
	\end{vmatrix}= a_{11}\left(-1\right)^{2}\left(a_{22}a_{33}-a_{32}a_{23}\right)+a_{12}\left(-1\right)^{2}\left(a_{21}a_{33}-a_{31}a_{23}\right)+\ldots& \\
	&\left|\mathbf{AB}\right|=\left|\mathbf{A}\right|\cdot\left|\mathbf{B}\right|\rightarrow\mathbf{AB}=\frac{1}{\sqrt{5}}
	\begin{pmatrix}
	3 & -1 \\
	-3 & 1
	\end{pmatrix}
	\rightarrow\left|\mathbf{AB}\right|=\frac{1}{5}\left(3-3\right)=0& \\
	&\tr\left(\mathbf{A}\right)=-1-1=-2,\quad\tr\left(\mathbf{B}\right)=0& \\
	&\lambda_{1}^{A}=-2,\quad\lambda_{2}^{A}=0\quad\rightarrow\quad\tr\left(\mathbf{A}\right)=\sum_{i}\lambda_{i}^{A}& \\
	&\lambda_{1}^{B}=1,\quad\lambda_{2}^{B}=-1\quad\rightarrow\quad\tr\left(\mathbf{B}\right)=\sum_{i}\lambda_{i}^{B}& \\
	&\left|\mathbf{A}\right|=\lambda_{1}^{A}\lambda_{2}^{A}=\prod_{i}\lambda_{i}^{A}&
\end{align*}

\subsection*{c)}
\begin{align*}
	&\tr\left(\mathbf{AB}\right)=\tr\left(\mathbf{BA}\right)\quad\forall\mathbf{A, B} \text{: square matrix N$\times$N}& \\
	&\mathbf{C=AB}\quad\rightarrow\quad c_{m,n}=\sum_{k}a_{m,k}b_{k,n}\quad\rightarrow\quad\tr\left(\mathbf{C}\right)=\sum_{i=1}^{N}c_{i,i}=\sum_{i=1}^{N}\sum_{k=1}^{N}a_{i,k}b_{k,i}& \\
	&\mathbf{D=BA}\quad\rightarrow\quad d_{m,n}=\sum_{k}b_{m,k}a_{k,n}\quad\rightarrow\quad\tr\left(\mathbf{D}\right)=\sum_{i=1}^{N}d_{i,i}=\sum_{i=1}^{N}\sum_{k=1}^{N}b_{i,k}a_{k,i}&
\end{align*}

\subsection*{d)}
\qquad\circled{1}
\begin{align*}
	&\text{positive definite matrix :}& &\text{$\forall i$, $\lambda_{i}>0$}& \\
	&\text{positive semidefinite matrix :}& &\text{$\forall i$, $\lambda_{i}\ge 0$}& \\
	&\text{negative definite matrix :}& &\text{$\forall i$, $\lambda_{i}<0$}& \\
	&\text{negative semidefinite matrix :}& &\text{$\forall i$, $\lambda_{i}\le 0$}& \\
	&\mathbf{A}:\quad\lambda_{i}^{A}\le 0\quad\Rightarrow\quad\text{negative semidefinite}& \\
	&\mathbf{B}:\quad\text{indefinite}&
\end{align*}
\qquad\circled{2}
\begin{align*}
	\mathbf{X}^{H}=\mathbf{X}\quad\rightarrow\quad\mathbf{X}^{T}=\mathbf{X}\quad\rightarrow\quad\mathbf{A, B}\text{: hermitian}
\end{align*}
\qquad\circled{3}
\begin{align*}
	&\rank\left(
	\begin{pmatrix}
	-1 & 1 \\
	1 & -1
	\end{pmatrix}
	\right)\rightarrow\rank\left(\mathbf{A}\right)=1& \\
	&\rank\left(\frac{1}{\sqrt{5}}
	\begin{pmatrix}
	-1 & 2 \\
	2 & 1
	\end{pmatrix}
	\right)=
	\rank\left(\frac{1}{\sqrt{5}}\left(\mathbf{b}_{1}\quad\mathbf{b}_{2}\right)\right)& \\
	&\beta_{1}\mathbf{b}_{1}+\beta_{2}\mathbf{b}_{2}=0\quad\rightarrow\quad
	\begin{pmatrix}-1\\2\end{pmatrix}+\beta_{2}\begin{pmatrix}2\\1\end{pmatrix}=\begin{pmatrix}0\\0\end{pmatrix}& \\
	&\Rightarrow\beta_{2}=-\frac{1}{2},\quad\beta_{2}=-2\quad\lightning& \\
	&\Rightarrow\quad\rank\left(\mathbf{B}\right)=2&
\end{align*}
\qquad\underline{Important property:}
\begin{align*}
	\mathbf{X}\text{ has full rank}\quad\rightarrow\quad\left|\mathbf{X}\right|\neq 0\text{ or $\mathbf{X}$ is invertible} \\
\end{align*}
\qquad\circled{4}
\begin{align*}
	&\left|\mathbf{A}\right|=0\quad\Rightarrow\quad\text{$\mathbf{A}$ nicht invertierbar}& \\
	&\left|\mathbf{B}\right|=-1\quad\Rightarrow\quad\text{$\mathbf{B}$ invertierbar}&
\end{align*}
\qquad\circled{5}
\begin{align*}
	&\mathbf{X}\text{ is unitary}\quad\Leftrightarrow\quad\mathbf{X\cdot X}^{H}=\mathbf{T},\quad\mathbf{X}\text{: unitary}\rightarrow\mathbf{X}^{-1}=\mathbf{X}^{H}& \\
	&\mathbf{AA}^{H}=
	\begin{pmatrix}
	-1 & 1 \\
	1 & -1
	\end{pmatrix}
	\begin{pmatrix}
	-1 & 1 \\
	1 & -1
	\end{pmatrix}=
	\begin{pmatrix}
	2 & -2 \\
	-2 & 2
	\end{pmatrix}&&\Rightarrow\mathbf{A}\text{ is not unitary}& \\
	&\mathbf{BB}^{H}=\frac{1}{5}
	\begin{pmatrix}
	-1 & 2 \\
	2 & 1
	\end{pmatrix}
	\begin{pmatrix}
	-1 & 2 \\
	2 & 1
	\end{pmatrix}=
	\begin{pmatrix}
	1 & 0 \\
	0 & 1
	\end{pmatrix}=\mathbf{I}&&\Rightarrow\mathbf{B}\text{ is unitary}&
\end{align*}

\subsection*{e) }
\begin{align*}
	&\left|\mathbf{I+AB}\right|=\left|\mathbf{I+BA}\right|& \\
	&\left|\mathbf{I+AB}\right|=\left|
	\begin{pmatrix}
	1 & 0 \\
	0 & 1
	\end{pmatrix}+\frac{1}{\sqrt{5}}
	\begin{pmatrix}
	3 & -1 \\
	-3 & 1
	\end{pmatrix}\right|=2,7789& \\
	&\left|\mathbf{I+BA}\right|=\left|
	\begin{pmatrix}
	1 & 0 \\
	0 & 1
	\end{pmatrix}+\frac{1}{\sqrt{5}}
	\begin{pmatrix}
	3 & -3 \\
	-1 & 1
	\end{pmatrix}\right|=2,7789& \\
	&&\blacksquare
\end{align*}

\subsection*{f) }
\begin{align*}
	&\mathbf{X}^{-1}=\frac{1}{\left|\mathbf{X}\right|}\adj\left(\mathbf{X}\right),\quad\adj\left(\mathbf{X}\right)=\text{ Transpose of cofactor matrix}& \\
	&\mathbf{X}=
	\begin{pmatrix}
	x_{11} & x_{12} & x_{13} \\
	x_{21} & x_{22} & x_{23} \\
	x_{31} & x_{32} & x_{33}
	\end{pmatrix}=\frac{1}{\det\mathbf{X}}
	\begin{pmatrix}
		\left(x_{22}x_{33}-x_{32}x_{23}\right) & \cdots & \cdots \\
		\cdots & \cdots & \cdots \\
		\cdots & \cdots & \cdots
	\end{pmatrix}& \\
	&\mathbf{B}=
	\begin{pmatrix}
	b_{11} & b_{12} \\
	b_{21} & b_{22}
	\end{pmatrix}& \\
	&\rightarrow\quad\mathbf{B}^{-1}=\frac{1}{\det\mathbf{B}}
	\begin{pmatrix}
	b_{22} & -b_{21} \\
	-b_{21} & b_{11}
	\end{pmatrix}^{T}=\frac{1}{-1}
	\begin{pmatrix}
	\frac{1}{\sqrt{5}} & -\frac{2}{\sqrt{5}} \\
	-\frac{2}{\sqrt{5}} & -\frac{1}{\sqrt{5}}
	\end{pmatrix}^{T}& \\
	&\rightarrow\quad\mathbf{B}^{-1}=
	\begin{pmatrix}
	-\frac{1}{\sqrt{5}} & \frac{2}{\sqrt{5}} \\
	\frac{2}{\sqrt{5}} & \frac{1}{\sqrt{5}}
	\end{pmatrix},\quad\left|\mathbf{B}^{-1}\right|=-1\quad\Rightarrow\left|\mathbf{B}^{-1}\right|=\frac{1}{\left|\mathbf{B}\right|}& \\
	&&\blacksquare
\end{align*}

\subsection*{g) }
\begin{align*}
	&\rank\left(\mathbf{A}\right)=1,\quad\rank\left(\mathbf{B}\right)=2& \\
	&\mathbf{AB}=\frac{1}{\sqrt{5}}
	\begin{pmatrix}
	3 & -1 \\
	-3 & 1
	\end{pmatrix},\quad
	\begin{pmatrix}3\\-3\end{pmatrix}=-3\begin{pmatrix}-1\\1\end{pmatrix}\quad\rightarrow\quad\rank\left(\mathbf{AB}\right)=1& \\
	&\rank\left(\mathbf{AB}\right)\le\min\{\rank\left(\mathbf{A}\right), \rank\left(\mathbf{B}\right)\}&
\end{align*}

\subsection*{h) }
\begin{align*}
	&\|\bullet\|: \mathbb{C}^{M\times N}\quad\rightarrow\quad\mathbb{R}& \\\\
	&\text{Axioms for norm function:}&\\
	&1.)\quad\|\mathbf{X}\|\ge 0,\quad\|\mathbf{X}\|=0 \text{ if and only if }\mathbf{X}=0& \\
	&2.)\quad\|\alpha\mathbf{X}\|=\left|\alpha\right|\|\mathbf{X}\|& \\
	&3.)\quad\|\mathbf{X+Y}\|\le\|\mathbf{X}\|+\|\mathbf{Y}\|& \text{(triangular property)} \\
	&4.)\quad\|\mathbf{XY}\|\le\|\mathbf{X}\|\cdot\|\mathbf{Y}\|&
\end{align*}

\subsection*{i)}
\begin{align*}
	&\|\alpha\mathbf{X}\|_{F}=\sqrt{\sum_{i}\sum_{j}\left|\alpha\mathbf{X}\right|^{2}}=\left|\alpha\right|\sqrt{\sum_{i}\sum_{j}\left|\mathbf{X}\right|^{2}}=\left|\alpha\right|\|\mathbf{X}\|_{F}& &\text{Axiom 2}& \\
	&\|\mathbf{X+Y}\|_{F}^{2}\le\|\mathbf{X}\|_{F}^{2}+\|\mathbf{Y}\|_{F}^{2}& &\text{Axiom 3}& \\
	&\|\mathbf{X+Y}\|_{F}^{2}=\sum_{i}\sum_{j}\left|x_{ij}+y_{ij}\right|^{2}& &\text{Axiom 4}& \\
	&\qquad\le\sum_{i}\sum_{j}\left|x_{ij}\right|^{2}+\sum_{i}\sum_{j}\left|y_{ij}\right|^{2}=\|\mathbf{X}\|_{F}^{2}+\|\mathbf{Y}_{F}^{2}& \\
	&\qquad\|\mathbf{XY}\|_{F}^{2}\le\|\mathbf{X}\|_{F}^{2}\cdot\|\mathbf{Y}\|_{F}^{2}& \\
	&\qquad\rightarrow\|\mathbf{XY}\|_{F}^{2}=\sum_{i}\sum_{j}\mathbf{XY}\le\sum_{i}\sum_{j}\left|x_{ij}\right|^{2}\cdot\sum_{i}\sum_{j}\left|y_{ij}\right|^{2}=\|\mathbf{X}\|_{F}^{2}\cdot\|\mathbf{Y}\|_{F}^{2} & \\
	& &\blacksquare
\end{align*}

\subsection*{j)}
\begin{align*}
	&\mathbf{A\otimes B\neq B\otimes A}& \\
	&\mathbf{A}=
	\begin{pmatrix}
	-1 & 1 \\
	1 & -1 
	\end{pmatrix},\quad\mathbf{B}=\frac{1}{\sqrt{5}}
	\begin{pmatrix}
	-1 & 2 \\
	2 & 1
	\end{pmatrix}& \\
	&\mathbf{A\otimes B}=
	\begin{bmatrix}
	a_{ij} & \mathbf{B}
	\end{bmatrix}=\frac{1}{\sqrt{5}}
	\begin{pmatrix}
	1 & 2 & -1 & 2 \\
	-2 & 1 & 2 & 1 \\
	-1 & 2 & 1 & -2 \\
	2 & 1 & -2 & -1
	\end{pmatrix}& \\
	&\mathbf{B\otimes A}=
	\begin{bmatrix}
	b_{ij} & \mathbf{A}
	\end{bmatrix}=\frac{1}{\sqrt{5}}
	\begin{pmatrix}
	1 & -1 & -2 & 2 \\
	-1 & 1 & 2 & -1 \\
	-2 & 2 & -1 & 1 \\
	2 & -2 & 1 & -1
	\end{pmatrix}& \\
	&\Rightarrow\mathbf{A\otimes B\neq B\otimes A}& \\
	& &\blacksquare
\end{align*}

\subsection*{k)}
\begin{align*}
	&\text{Hadamard's Inequality: }\left|\mathbf{A}\right|\le\prod_{k=1}^{K}a_{kk}& \\
	&\mathbf{A}=
	\begin{pmatrix}
	1 & 2 & -1 \\
	2 & -2 & -1 \\
	3 & 1 & 0
	\end{pmatrix}=1-2\left(3\right)-1\left(2+6\right)=-13& \\
	&\prod_{k=1}^{3}a_{kk}=0\quad\rightarrow\quad\det\left(\mathbf{A}\right)=-13\le\prod_{k=1}^{3}a_{kk}& \\
	&\tilde{\mathbf{A}}=
	\begin{pmatrix}
	1 & 0 & 0 \\
	0 & -2 & 0 \\
	0 & 0 & 0
	\end{pmatrix}\quad\rightarrow\quad\left|\tilde{\mathbf{A}}\right|=1\left(-2\right)0=0& \\
	&\qquad\rightarrow\text{off-diagonal elements should set to zero}\leftrightarrow\left|\mathbf{A}\right|=\prod_{k=1}^{K}a_{kk}&
\end{align*}

\section*{Problem 2}
\begin{align*}
	\mathbf{A}=
	\begin{pmatrix}
	1 & 0,5 & -0,5 \\
	-1 & 1 & -1
	\end{pmatrix}
\end{align*}

\subsection*{a)}
\begin{align*}
	&\rank\left(\mathbf{A}\right):\quad\alpha\begin{pmatrix}1\\0,5\\-0,5\end{pmatrix}+\beta\begin{pmatrix}-1\\1\\-1\end{pmatrix}\overset{!}{=}0& \\
	&\text{we set $\beta=1$ w/o loss of generality}& \\
	&\rightarrow\quad\alpha-1=0\quad\Rightarrow\quad\alpha=1& \\
	&\quad 0,5\alpha+1=0\quad\Rightarrow\quad\alpha=-2\quad\lightning& \\
	&\Rightarrow\rank\left(\mathbf{A}\right)=2&
\end{align*}

\subsection*{b)}
\begin{align*}
	&\mathbf{A=U\Sigma V}^{H}\qquad\svd\left(\mathbf{A}\right)\quad\text{(singular value decomposition)}& \\
	&\tilde{\mathbf{A}}=\mathbf{AA}^{T}=
	\begin{pmatrix}
	1,5 & 0 \\
	0 & 3
	\end{pmatrix}& \\
	&\det\left(\lambda\mathbf{I-A}\right)=0\quad\rightarrow\quad\det\left|
	\begin{pmatrix}
	\lambda-1,5 & 0 \\
	0 & \lambda-3
	\end{pmatrix}\right|=0& \\
	&\qquad\Rightarrow\quad\lambda_{1}=1,5,\quad\lambda_{2}=3& \\
	&\text{Eigenvectors $\mathbf{Ev}$:}& \\
	&\mathbf{\tilde{A}Ev}=\lambda\mathbf{Ev}& \\
	&\text{for $\lambda_{1}=1,5$:}& \\
	&\qquad\rightarrow\quad
	\begin{pmatrix}
	1,5 & 0 \\
	0 & 3
	\end{pmatrix}\begin{pmatrix}v_{1}\\v_{2}\end{pmatrix}=1,5\begin{pmatrix}v_{1}\\v_{2}\end{pmatrix}& \\
	&\qquad\rightarrow 1,5v_{1}=1,5v_{2},\quad 3v_{2}=1,5v_{1}& \\
	&\qquad\Rightarrow v_{1}=1,\quad v_{2}=0& \\
	&\qquad\Rightarrow\mathbf{Ev}_{1}=\begin{pmatrix}1\\0\end{pmatrix}& \\
	&\text{for $\lambda_{2}=3$:}& \\
	&\qquad\rightarrow\quad
	\begin{pmatrix}
	1,5 & 0 \\
	0 & 3
	\end{pmatrix}\begin{pmatrix}u_{1}\\u_{2}\end{pmatrix}=3\begin{pmatrix}u_{1}\\u_{2}\end{pmatrix}& \\
	&\qquad\rightarrow 1,5u_{1}=3u_{2},\quad 3u_{2}=3u_{1}& \\
	&\qquad\Rightarrow\mathbf{Ev}_{2}=\begin{pmatrix}0\\1\end{pmatrix}& \\
	&\mathbf{A=U\Sigma V}^{H},\quad\mathbf{U}=\begin{pmatrix}\mathbf{Ev_{1}} & \mathbf{Ev_{2}} & \ldots & \mathbf{Ev_{N}}\end{pmatrix}=
	\begin{pmatrix}
	1 & 0 \\
	0 & 1
	\end{pmatrix}&
\end{align*}

\subsection*{c)}
\begin{align*}
	&S_{u}^{2}:\text{ Eigenvalue of }\mathbf{XX}^{H}& \\
	&S_{u}:\text{ singular value of }\mathbf{X}& \\
	&\tr\left(\mathbf{XX}^{H}\right)=\sum_{u}\lambda_{u}\left(\mathbf{XX}^{H}\right)=\sum_{u}S_{u}^{2}&
\end{align*}

\subsection*{d)}
\begin{align*}
	&\text{QR-decomposition}\quad\rightarrow\quad\mathbf{A=QR}& \\
	&\qquad\text{with $\mathbf{Q}$ unitary, $\mathbf{R}$ upper triangular matrix}& \\
	&\text{Gram-Schmidt:}& \\
	&\mathbf{A}=
	\begin{bmatrix}
	1 & 0,5 & -0,5 \\
	-1 & 1 & -1 
	\end{bmatrix}=\begin{bmatrix}\mathbf{a}_{1}&\mathbf{a}_{2}&\mathbf{a}_{3}\end{bmatrix}& \\
	&\mathbf{u}_{1}=\mathbf{a}_{1}=\begin{bmatrix}1\\-1\end{bmatrix}& \\
	&\qquad\rightarrow\quad\mathbf{e}_{1}=\frac{\mathbf{u}_{1}}{\|\mathbf{u}_{1}\|}=\frac{1}{\sqrt{2}}\begin{bmatrix}1\\-1\end{bmatrix}& \\
	&\mathbf{u}_{2}=\mathbf{a}_{2}-\left(\mathbf{a}_{2}\mathbf{e}_{1}\right)\mathbf{e}_{1}=\begin{bmatrix}0,5\\1\end{bmatrix}-\left(\begin{bmatrix}0,5\\1\end{bmatrix}\begin{bmatrix}\frac{1}{\sqrt{2}}\\-\frac{1}{\sqrt{2}}\end{bmatrix}\right)=\begin{bmatrix}0,75\\0,75\end{bmatrix}& \\
	&\qquad\rightarrow\quad\mathbf{e}_{2}=\frac{\mathbf{u}_{2}}{\|\mathbf{u}_{2}\|}=\begin{bmatrix}\frac{1}{\sqrt{2}}\\\frac{1}{\sqrt{2}}\end{bmatrix}& \\
	&\mathbf{u}_{3}=\mathbf{a}_{3}-\left(\mathbf{a}_{3}\mathbf{e}_{1}\right)\mathbf{e}_{1}-\left(\mathbf{a}_{3}\mathbf{e}_{2}\right)\mathbf{e}_{2}=& \\
	&\qquad=\begin{bmatrix}-0,5\\-1\end{bmatrix}-\left(\begin{bmatrix}-0,5\\-1\end{bmatrix}\begin{bmatrix}\frac{1}{\sqrt{2}}\\-\frac{1}{\sqrt{2}}\end{bmatrix}\right)\begin{bmatrix}\frac{1}{\sqrt{2}}\\-\frac{1}{\sqrt{2}}\end{bmatrix}-\left(\begin{bmatrix}-0,5\\-1\end{bmatrix}\begin{bmatrix}\frac{1}{\sqrt{2}}\\\frac{1}{\sqrt{2}}\end{bmatrix}\right)\begin{bmatrix}\frac{1}{\sqrt{2}}\\\frac{1}{\sqrt{2}}\end{bmatrix}& \\
	&\qquad=\begin{bmatrix}-0,5\\-1\end{bmatrix}+\begin{bmatrix}-0,25\\0,25\end{bmatrix}+\begin{bmatrix}0,75\\0,75\end{bmatrix}=\begin{bmatrix}0\\0\end{bmatrix}& \\
	&\qquad\rightarrow\quad\mathbf{e}_{3}=\frac{\mathbf{u}_{3}}{\|\mathbf{u}_{3}\|}=\begin{bmatrix}0\\0\end{bmatrix}& \\
	&\mathbf{Q}=\begin{bmatrix}\mathbf{e}_{1}&\mathbf{e}_{2}&\mathbf{e}_{3}\end{bmatrix}=
	\begin{bmatrix}
	\frac{1}{\sqrt{2}} & \frac{1}{\sqrt{2}} & 0 \\
	\frac{1}{-\sqrt{2}} & \frac{1}{\sqrt{2}} & 0
	\end{bmatrix}& \\
	&\mathbf{R}=
	\begin{bmatrix}
	\mathbf{u}_{1}\mathbf{e}_{1} & \mathbf{u}_{2}\mathbf{e}_{1} & \mathbf{u}_{3}\mathbf{e}_{1} \\
	0 & \mathbf{u}_{2}\mathbf{e}_{2} & \mathbf{u}_{3}\mathbf{e}_{2} \\
	0 & 0 & \mathbf{u}_{3}\mathbf{e}_{3}
	\end{bmatrix}=
	\begin{bmatrix}
	\frac{2}{\sqrt{2}} & -\frac{1}{2\sqrt{2}} & \frac{1}{2\sqrt{2}} \\
	0 & \frac{3}{2\sqrt{2}} & \frac{3}{2\sqrt{2}} \\
	0 & 0 & 0
	\end{bmatrix}
\end{align*}

\subsection*{e)}
\begin{align*}
	&\mathbf{B}=
	\begin{bmatrix}
	-1 & 1 & -1 \\
	-0,5 & 0,5 & 1
	\end{bmatrix},&&\mathbf{A}=
	\begin{bmatrix}
	1 & 0,5 & -0,5 \\
	-1 & 1 & -1
	\end{bmatrix}& \\
	&\mathbf{B=QL}&&\text{$\mathbf{B}$ is updown and left-right flipped version of $\mathbf{A}$}& \\
	&& &\mathbf{B}=\UD\left(\LR\left(\mathbf{A}\right)\right)& \\
	&\mathbf{A=Q}_{A}\mathbf{R}_{A}& &\rightarrow\mathbf{B}=\UD\left(\LR\left(\mathbf{Q}_{A}\mathbf{R}_{A}\right)\right)=\mathbf{Q}_{B}\mathbf{L}_{B}& \\
	&& &\qquad\mathbf{Q}_{B}=\UD\left(\LR\left(\mathbf{Q}_{A}\right)\right)& \\
	&& &\qquad\mathbf{L}_{B}=\UD\left(\LR\left(\mathbf{R}_{A}\right)\right)& \\
	&\mathbf{Q}_{B}=\frac{1}{\sqrt{2}}
	\begin{bmatrix}
	0 & 1 & -1 \\
	0 & 1 & 1
	\end{bmatrix}&
	&\mathbf{L}_{B}=\frac{1}{\sqrt{2}}
	\begin{bmatrix}
	0 & 0 & 0 \\
	-1,5 & 1,5 & 0 \\
	0,5 & 0,5 & 2
	\end{bmatrix}&
\end{align*}


\subsection*{Gaussian Distribution, Entropy and Capacity}
\begin{align*}
	&\text{- Data rate}& \\
	&\text{- Reliability (BER, transmit power)}& \\
	&C = \ld\left(1+\SNR\right)& \\
	&\text{Differential Entropy: } h\left(x\right)=-\int\limits_{-\infty}^{\infty}f_{x}\left(x\right)\ld\left(f_{x}\left(x\right)\right)\mathrm{d}x& \\
	&C=\max\left(\mathrm{I}\left(x,y\right)\right)=\max\left(h\left(y\right)-h\left(n\right)\right)& \\
	&\qquad\text{maximized for $h\left(y\right)$ Gaussian}& \\
	&\text{noise$\quad\rightarrow\quad$average power is .......$\quad\rightarrow\quad$Gaussian is the most random noise}& \\
	&\text{signal$\quad\rightarrow\quad$using shaping techniques we get Gaussian distribution}& \\
	&C=\max\left(h\left(y\right)-h\left(n\right)\right)=\frac{1}{2}\ld\left(2\pi e\sigma_{y}^{2}\right)-\frac{1}{2}\ld\left(2\pi e\sigma_{n}^{2}\right)\overset{\sigma_{y}^{2}=\sigma_{x}^{2}+\sigma_{n}^{2}}{=}\frac{1}{2}\ld\left(1+\frac{\sigma_{x}^{2}}{\sigma_{n}^{2}}\right)& \\
\end{align*}
\begin{align*}
	&\text{water-filing: }\frac{P_{i}}{P}=
	\begin{cases}
	\frac{1}{\gamma_{0}}-\frac{\sigma_{n}^{2}}{P\|H_{i}\|^{2}} & \frac{\|H_{i}\|^{2}P}{\sigma_{n}^{2}}>\gamma_{0}\\
	0 & \frac{\|H_{i}\|^{2}P}{\sigma_{n}^{2}}\le\gamma_{0}\quad\rightarrow\quad\text{channel i is too bad, low SNR}
	\end{cases}& \\
	&P_{i}=\text{TX power of channel i}& \\
	&P=\text{total TX power}& \\
	&H_{i}=\text{gain of channel i}& \\
	&\sigma_{n}^{2}=N_{0}\cdot B& \\
	&\text{Channels}=
	\begin{cases}
	\text{AWGN:}\qquad\includegraphics[width=0.25\textwidth]{AWGN_channel.eps} & C_{T}=B\ld\left(1+\frac{\sigma_{x}^{2}}{\sigma_{n}^{2}}\right)\frac{\mathrm{bit}}{\mathrm{s}} \\
	\text{flat fading:}\qquad\includegraphics[width=0.3\textwidth]{flatfading_channel.eps} & C_{T}=B\ld\left(1+\frac{h^{2}\sigma_{x}^{2}}{\sigma_{n}^{2}}\right) \\
	\text{frequency selective:}\qquad\includegraphics[width=0.3\textwidth]{frequencyselective_channel.eps} & \\
	\end{cases}& \\
	&\includegraphics[width=0.5\textwidth]{frequencyselective_channel_2.eps}& \\
	&H_{i}\left(f\right)=\mathrm{const.}\quad\rightarrow\quad\text{Water-filling algorithm}& \\
	&\quad\qquad\qquad\qquad\rightarrow\quad\text{Allocate more power to better (with highter SNR) channels}& \\
	&\mathrm{dB}
	\begin{cases}
	\text{comparison: power $P_{1}$, $P_{2}\quad\rightarrow\quad P_{2}$ has $10\log\frac{P_{2}}{P_{1}}\mathrm{dB}$ more power than $P_{1}$} \\
	\text{absolute power: $\mathrm{dBm}$, $P_{2}=10\mathrm{W},\quad P_{1}=1\mathrm{W}\quad\rightarrow\quad P_{2}=10\log 10=10\mathrm{dB}$}
	\end{cases}& \\
	&\includegraphics[width=1\textwidth]{waterfilling.eps}& \\
\end{align*}
\begin{align*}
	&\gamma_{i}=\text{SNR of $i$th channel}& \\
	&P_{i}=\text{allocated power to the $i$th channel}& \\
	&\frac{P_{i}}{P}=
	\begin{cases}
	\frac{1}{\gamma_{0}}-\frac{1}{\gamma_{i}} & \frac{\left|H_{i}\right|^{2}P}{\sigma_{n}^{2}}=\frac{\left|H_{i}\right|^{2}P}{N_{0}B}\ge\gamma_{0} \\
	0 & \text{otherwise}
	\end{cases}& \\
	&\sigma_{n}^{2}=N_{0}B\quad\text{with noise power $\sigma_{n}^{2}$ and PSD of noise $N_{0}$}& \\
	&H_{i}=\text{transfer function (channel gain) of $i$th channel}& \\
	&\text{Constraint:}\quad\sum_{i=1}^{3}P_{i}=P\quad\text{total transmit power}& \\
	&\sum_{i=1}^{3}P_{i}=P\quad\rightarrow\quad\sum_{i=1}^{3}\left(\frac{1}{\gamma_{0}}-\frac{1}{\gamma_{i}}\right)P=P\quad\rightarrow\quad\boxed{\sum_{i=1}^{3}\left(\frac{1}{\gamma_{0}}-\frac{1}{\gamma_{i}}\right)P=1}& \\
	&\gamma_{1}=\frac{\left|H_{1}\right|^{2}P}{N_{0}B}=\frac{1\cdot 10^{-3}}{10^{-11}\cdot 1ß^{7}}\quad\rightarrow\quad\gamma_{1}=10\quad\rightarrow\quad\text{best channel}& \\
	&\gamma_{2}=\frac{\left|H_{2}\right|^{2}P}{N_{0}B}=10H_{2}^{2}\quad\rightarrow\quad\gamma_{2}=2,5& \\
	&\gamma_{3}=\frac{\left|H_{3}\right|^{2}P}{N_{0}B}=10H_{3}^{2}\quad\rightarrow\quad\gamma_{3}=0,9\quad\rightarrow\quad\text{worst channel}& \\
	&\sum_{i=1}^{3}\left(\frac{1}{\gamma_{0}}-\frac{1}{\gamma_{i}}\right)=1\quad\Rightarrow\quad\frac{3}{\gamma_{0}}=1+\frac{1}{\gamma_{1}}+\frac{1}{\gamma_{2}}+\frac{1}{\gamma_{3}}\quad\rightarrow\quad\gamma_{0}=1,15\quad\text{(water level)}& \\
	&\qquad\rightarrow\text{water level check}\quad\rightarrow\quad\gamma_{i}>\gamma_{0}\forall i& \\
	&\gamma_{1}=10>\gamma_{0}\quad\checkmark& \\
	&\gamma_{2}=2,5>\gamma_{0}\quad\checkmark& \\
	&\gamma_{3}=0,9<\gamma_{0}\quad\lightning\quad\rightarrow\quad\text{no power can be allocated to channel 3}& \\
	&\sum_{i=1}^{2}\left(\frac{1}{\gamma_{0}}-\frac{1}{\gamma_{i}}\right)=1\quad\rightarrow\quad\frac{2}{\gamma_{0}}=1+\frac{1}{10}+\frac{1}{2,5}\quad\rightarrow\quad\gamma_{0}=1,33& \\
	&\gamma_{1}=10>\gamma_{0}\quad\checkmark& \\
	&\gamma_{2}=2,5>\gamma_{0}\quad\checkmark& \\
	&\quad\rightarrow\quad C_{\mathrm{T}}=B\sum\limits_{i=1}^{2}\ld\left(1+\frac{\left|H_{1}\right|^{i}P}{N_{0}B}\right)=B\sum\limits_{i=1}^{2}\ld\left(1+\frac{\gamma_{i}}{\gamma_{0}}-1\right)=B\sum\limits_{i=1}^{2}\ld\left(\frac{\gamma_{i}}{\gamma_{0}}\right)& \\
	&\qquad C_{\mathrm{T}}=10^{7}\left(\ld\left(\frac{10}{1,33}\right)+\ld\left(\frac{2,5}{1,33}\right)\right)\quad\rightarrow\quad C_{\mathrm{T}}=38,2\text{ Mbits/s}& \\
	&\qquad C_{\mathrm{T}}=B\ld\left(1+\frac{S}{N}\right)\quad\text{Shannon formula}& \\
\end{align*}

\section*{Problem 4}
\begin{align*}
	&\text{Multiplexing gain}\qquad\qquad G_{\mathrm{m}}=\lim_{\mathrm{SNR}\rightarrow\infty}\frac{R}{\ld\left(\mathrm{SNR}\right)}& \\
	&\text{Diversity gain}\quad\qquad\qquad C=\ld\left(1+\mathrm{SNR}\right)\quad\Rightarrow\quad C\overset{\mathrm{SNR}\rightarrow\infty}{\approx}\ld\left(\mathrm{SNR}\right)& \\
	&\includegraphics[width=0.7\textwidth]{MIMO_channel.eps}& \\
	&\text{Multiplexing gain $=$ number of parallel independent equivalent channels}& \\
	&\svd\left(H\right)\quad\rightarrow\quad\text{singular values of $H$: $\sigma_{i}^{2}$, $i\in\{1,2,\ldots,\rank\left(H\right)\}$}& \\
	&\rank\left(H\right)\quad\rightarrow\quad\text{number of singular values}& \\
	&H_{1}=
	\begin{bmatrix}
	1 & 1 & -1 \\
	-1 & 1 & 1 \\
	-1 & -1 & 1
	\end{bmatrix}\quad\rightarrow\quad\rank\left(H_{1}\right)=2& \\
	&\text{Matlab/Octave}\quad\rightarrow\quad\svd\left(H_{1}\right)=\mathbf{U}_{1}\mathbf{\Sigma}_{1}\mathbf{V}_{1}^{H}& \\
	&\qquad\mathbf{\Sigma}_{1}=
	\begin{bmatrix}
	2,56 & 0 & 0 \\
	0 & 1,56 & 0 \\
	0 & 0 & 0 
	\end{bmatrix}\quad\rightarrow\quad\text{$\sigma_{1}=2,56$, $\sigma_{2}=1,56$, $\sigma_{3}=0$ $\rightarrow$ useless}& \\
	&H_{2}=
	\begin{bmatrix}
	1 & -1 & -1 \\
	-1 & -1 & 1 \\
	1 & -1 & 1
	\end{bmatrix}\quad\rightarrow\quad\rank\left(H_{2}\right)=3\quad\rightarrow\quad\text{full rank}& \\
	&\svd\left(H_{1}\right)=\mathbf{U}_{2}\mathbf{\Sigma}_{2}\mathbf{V}_{2}^{H}& \\
	&\qquad\mathbf{\Sigma}_{2}=
	\begin{bmatrix}
	2 & 0 & 0 \\
	0 & 2 & 0 \\
	0 & 0 & 1 
	\end{bmatrix}\quad\rightarrow\quad\text{$\sigma_{1}=2$, $\sigma_{2}=2$, $\sigma_{3}=1$}& \\
\end{align*}

\section*{Problem 5}
\begin{align*}
	&\text{MIMO channel capacity}& \\ 
	&\text{short review:}& \\
	&\text{1 - channel matrix is deterministic and known to the transmitter}& \\
	&\text{2 - channel matrix is random and changes during the transmission of a code word}& \\
	&\qquad\text{$\rightarrow$ ergodic capacity}& \\
	&\text{3 - channel matrix is random and fixed during the transmission of a code word,}& \\ 
	&\qquad\text{but only known to TX}& \\
	&\text{Decompose the MIMO channel to subchannels}& \\
	&C_{\mathrm{T}}=B\sum_{i=1}^{N}\left[\ld\underbrace{\left(\frac{x_{i}^{2}}{\sigma_{n}^{2}}\mu\right)}_{\substack{\text{equivalent SNR} \\ \text{of channel $i$}}}\right]& \\
	&\qquad B:\quad\text{Bandwidth}& \\
	&\qquad x_{i}:\quad\text{singular value of H}& \\
	&\qquad\sigma_{n}^{2}:\quad\text{noise power}& \\
	&\qquad\mu :\quad\text{water level}& \\
	&\svd\left(\mathbf{H}\right)=\svd\left(
	\begin{bmatrix}
	0,2 & -0,2 & 0,2 \\
	0,1 & 0,4 & -1 \\
	1 & 0,2 & 1
	\end{bmatrix}\right)=\mathbf{U\Sigma V}^{H}& \\
	&\qquad\mathbf{\Sigma}=
	\begin{bmatrix}
	1,61 & 0 & 0 \\
	0 & 0,82 & 0 \\
	0 & 0 & 0,2
	\end{bmatrix}\quad\rightarrow\quad
	\begin{matrix}
	x_{1} = 1,61 \\
	x_{2} = 0,82 \\
	x_{3} = 0,2
	\end{matrix}& \\
	&\frac{P}{\sigma_{n}^{2}}=10\mathrm{dB}\quad\rightarrow\quad\frac{P}{\sigma_{n}^{2}}=10& \\
	&\gamma_{1}=x^{2}\frac{P}{\sigma_{n}^{2}}=1,61^{2}\cdot 10=25,9& \\
	&\gamma_{2}=0,82^{2}\cdot 10=7,6& \\
	&\gamma_{3}=0,2^{2}\cdot 10=0,4& \\
	&\qquad\text{3 non-zero singular values $\rightarrow$ number of parallel independent channels $=3$}& \\
	&\sum_{i=1}^{3}\left(\mu-\frac{1}{\gamma_{i}}\right)=1& \\
	&\qquad\rightarrow\quad 3\mu=\frac{1}{\gamma_{1}}+\frac{1}{\gamma_{2}}+\frac{1}{\gamma_{3}}+1=3,7\quad\rightarrow\quad\mu=1,23\quad\text{water level}&
\end{align*}
\begin{align*}
	&\text{water level check:}
	\begin{cases}
	\frac{1}{\gamma_{1}}=0,039<\mu\quad\checkmark \\
	\frac{1}{\gamma_{2}}=0,15<\mu\quad\checkmark \\
	\frac{1}{\gamma_{3}}=2,5>\mu \quad\lightning\quad\text{3rd channel doesn't have enough SNR}
	\end{cases}& \\
	&\qquad\Rightarrow\quad\text{no power can be allocated to 3rd channel}& \\
	&\qquad\Rightarrow\quad\text{allocate power in 1st and 2nd channel}& \\
	&\rightarrow\sum_{i=1}^{2}\left(\mu-\frac{1}{\gamma_{i}}\right)=1& \\
	&\rightarrow 2\mu=\frac{1}{\gamma_{1}}+\frac{1}{\gamma_{2}}+1=1,19\quad\rightarrow\quad\mu=0,595\quad\text{water level}& \\
	&\text{water level check:}
	\begin{cases}
	\frac{1}{\gamma_{1}}<\mu\quad\checkmark \\
	\frac{1}{\gamma_{2}}<\mu\quad\checkmark \\
	\end{cases}& \\
	&\rightarrow C_{\mathrm{T}}=B\sum_{i=1}^{2}\ld\left(\mu\gamma_{i}\right)=10^{6}\left(\ld\left(\frac{25,9}{0,595}\right)+\ld\left(\frac{6,7}{0,595}\right)\right)& \\
	&\rightarrow C_{\mathrm{T}}=8,937\text{ Mbit/s}& \\
	&\text{no CSIT: }& \\
	&\rightarrow C_{\mathrm{T}}=B\sum_{i=1}^{3}\ld\left(1+x_{i}^{2}\frac{P_{i}}{\sigma_{n}^{2}}\right)=B\sum_{i=1}^{3}\ld\left(1+x_{i}^{2}\frac{P}{3\sigma_{n}^{2}}\right)& \\
	&\rightarrow C_{\mathrm{T}}=10^{6}\left(\ld\left(1+8,64\right)+\ld\left(1+2,24\right)+\ld\left(1+0,13\right)\right)& \\
	&\rightarrow C_{\mathrm{T}}=5,14\text{ Mbit/s}& \\
	&\text{no CSIT at transmitter result in approx. $3,8$ Mbit/s data rate degradation}&
\end{align*}

\begin{align*}
&\text{Hier fehlen Aufgabe 6-7???}& \\
&\text{das folgende gehört zu Aufgabe 8 SISO Rayleigh fading channel}& \\
&\text{ACHTUNG: doppelte Nummerierung: Aufgabe 8 Receiver diversity, MRC, EGC and SC}&
\end{align*}


\end{document}